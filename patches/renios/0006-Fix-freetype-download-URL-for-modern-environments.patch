From 684fe004e7b933da5aedbe8786898b57a8fc0dee Mon Sep 17 00:00:00 2001
From: fatalc <cnfatal@gmail.com>
Date: Tue, 17 Feb 2026 03:15:36 +0800
Subject: [PATCH 6/8] Fix freetype download URL for modern environments

- Use HTTPS + curl -fL to avoid fetching redirect/error HTML
- Use freetype-old/ mirror path (freetype 2.4.12 moved to old archive)
- Add --retry 3 --retry-delay 5 to handle transient server errors
---
 dependencies/scripts/build-freetype.sh | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dependencies/scripts/build-freetype.sh b/dependencies/scripts/build-freetype.sh
index 8d66834..bc5877b 100755
--- a/dependencies/scripts/build-freetype.sh
+++ b/dependencies/scripts/build-freetype.sh
@@ -4,7 +4,7 @@
 
 if [ ! -f $CACHEROOT/freetype-$FREETYPE_VERSION.tar.gz ]; then
   echo "Downloading freetype source"
-  try curl -L http://download.savannah.gnu.org/releases/freetype/freetype-$FREETYPE_VERSION.tar.gz > $CACHEROOT/freetype-$FREETYPE_VERSION.tar.gz
+  try curl -fL --retry 3 --retry-delay 5 https://download.savannah.gnu.org/releases/freetype/freetype-old/freetype-$FREETYPE_VERSION.tar.gz > $CACHEROOT/freetype-$FREETYPE_VERSION.tar.gz
 fi
 
 echo "Unpacking freetype"
-- 
2.52.0

